---
title: 4月中旬
layout: page
---

## 2021-04-11

今朝はReactNative for Macをいじっていた。別ページに分けよう。

[ReactNative for macOSを触ってみた雑感](https://karino2.github.io/2021/04/11/reactnative_for_macOS_firstimpression.html)

結論としては、当面はElectronでいいかな、という気分になった。ただ用途によってはReact Native for macOSもアリかな、とは思った。

ふと、このブログのpostのmdを[TeFWiki](https://karino2.github.io/2021/04/10/TeFWiki.html)のフォルダにハードリンクを貼ってみたら、編集出来た！
おお、ハードリンク(・∀・)ｲｲﾈ!!

いつも自分の日記のファイル開くの面倒だなぁ、と思ってたんだよな。今後はWikiから編集しよう。

TeFWikiは使ってみると手応えを感じるな。ちゃんとアイコン書いてちゃんとリリースしよう。

少しAndroid版を作ろうかと思ってGoogle Drive周辺をいじっているが、いろいろ面倒だなぁ。
ローカルに保存してsyncする方が断然良いよなぁ。
という事で、[Play: AutoSync for GoogleDrive](https://play.google.com/store/apps/details?id=com.ttxapps.drivesync&hl=en&gl=US)は割と素直な動きをしているので、ローカルのディレクトリにテキストファイルでWikiを作るアプリを作ろう。

いい機会なので少しStorageAccessFrameworkをつついていると、最初の導入のドキュメントが明らかに間違っていて、DocmentsContractとかを手で呼ばないと動かない。
うーん、と思っていたら、androidxのDocumentFileは割と期待通りの動作をしていて、
これなら使ってやろう、という気分になった。

夜はしばらくjetbrainのmarkdownパーサーと格闘。パラグラフのgeneratorをオーバーライドしてwikilink対応は出来そうかな。

## 2021-04-12

ヨドからUSB-C microUSB変換アダプタが届いたので、長い事放置していた、以前端末クラッシュ時にバックアップだけになった「いつなに」からcsvデータをサルベージする。
「いつなに」、アイコン描くのが面倒でアプリは公開してないが、割と便利なんだよな。
エクスポートをつけたいと思いつつはや二年。端末がクラッシュした時だけ困る。

ついでに、てきすとでっき、のいらないメモを手動でarchiveフォルダのテキストファイルに移していく。
このローテク感が良い。
割と雑に作ったElectron版のてきすとでっきも、作ってみると結構便利だな。
PC用のアプリってやっぱ要るよなぁ。
どうでもいい事はtwitterじゃなくててきすとでっきにつぶやく事に成功している。ヨドから荷物届いた、とか。

この日記はTeFWikiで書いているんだが、スクロールした下にもEditボタンが欲しいな。上までスクロールで戻るの面倒。
そもそもtextareaって長いの書くのにいまいちだよな。MDMinaosiみたいにパラグラフ単位で編集出来る方がいいんだが、
あれはパラグラフを統合したり削除したりするのがやりにくいんだよなぁ。

花粉はもうたまにちょっと感じる程度なんだが、アイボンが余ってるのでアイボンしている。
アイボンは手間はかかるがスッキリはするので、シャワー浴びるのと同じような気分転換枠になってる気もする。

夜はちょっとjetbrainのパーサーをWIkiLinkにするのにチャレンジ。
PARAGRAPHジェネレータで子供を見て処理しようとしたら、素の奴はうまく行ったがリストの中ではうまく行かない。
リストの中はGFMはチェックボックスとかでかなり特殊な処理が入っていて、うまい事差し替えるのが難しい。
うーん、パーサーで差し替えられる方が嬉しいよなぁ。
明日はパーサーを調べてみよう。

## 2021-04-13

仕事で作ってるものが、ちょうどギリギリ今のハードウェアで使い物になりそうなラインを攻めていて、なかなか楽しい。
今回の仕事、自分はやるべき事はやっている感じがするな。これで勝てなかったらしゃーない。

夕方から夜にかけてはAndroid版のTeFWikの続き。パーサーは結局wikilinkをちゃんと扱うパーサーを追加するだけでいい感じに出来た。
良く出来ているなぁ、jetbrainのmarkdownパーサー。

Markdownの表示はwebviewにするかTextViewにするか迷ったが、
Html.fromHtmlではリンクをハンドルするのが思ったよりかったるく、webviewだとgetElementByIdとかが使えないので細かい処理が面倒、というどっちもいまいちという感じに。
なんかこのリンクたどるのかったるい、は何度かやった記憶が蘇ってきたな。TagHandlerでカスタムなスパンぶら下げるんだっけ。だるい。

結局全htmlをテキスト処理で作ってwebviewのloadDataする、というやる気無いソリューションで行く事に。
リンク辿るのが一瞬引っかかる事になりそうだが、まぁいいや。

表示してリンクをたどるのがなんとなく動いた所でgit initをする。
これまで実装した事無いような部分の実装はすべて終わったので、あとはやれば出来そう。
結構いいんじゃないかな？これ。

## 2021-04-14

Modern Design Componentのカタログアプリを動かしたりしてみる。MDC、動画とかはたまに見ていたが。

いろいろおもしろいが、今回のアプリではDrawerくらいかなぁ、そしてDrawerはMDCには入ってない。
しかもDrawer Layout、Navigation Componentがゴミで、これと抱き合わせようとした解説しか公式文書に無いので使いにくかったりする。
こういうの見るとGoogle分割しないとどうにもならんな、という気分になるよなぁ。

今回のアプリでは出番は無いが結構面白いUIパーツが多いので、MDCは使っていこうという気分にはなった。
Jetpack Commposeが正式リリースされたら組み合わせてだいぶいい感じになりそうだな。

### TeFWikiは何故素晴らしいのか？

[TeFWiki](https://karino2.github.io/2021/04/10/TeFWiki.html)、使う気無く作ったのだけれど、出来てみるとめっちゃ良くて、使いまくっている。

エディタでローカルのWIkiみたいなのは昔良く使っていて、たしかに便利ではあったのだが、今回は明らかにそれらと違う。どこが違うのか考えてみる。

まず、エディタじゃない、というのが大きい気がする。画面がおしゃれ感があるというのもあるけれど、
それよりも見やすさが重要なんじゃないか。
プレーンテキストよりも明らかに見やすい。
それは普段がビューモードでちゃんとHtmlとしてレンダリングされているからだよな。
キーボードじゃなくてタッチパッドでブラウズするのが気分いいんだよね。
あと、外部リンクは普通にブラウザが開き、これも便利だ。
ローカルで使うWikiでも、ちゃんとmarkdownをパースしてWebViewで表示するのが大切だった。
これは今回使ってみるまで予想外だった事だ。

見た目がなんか良い、という点では、bulma.cssを使ったのも結構大きい気がする。
これがいつものやる気無い見た目じゃなくすので、なんか「おっ？」って気分になるんだよな。
大した事はしてないんだが。
書くよりも見る方が重視されているので、見るのが快適で、なんども見る。
その結果、なんか書きたくなるんだよな。

もうひとつ思うのは、ローカルのマークダウンのプレーンテキストファイルのみでメタデータ無し、というのが良い。
Google Driveにプレーンテキストなので、これまでのテキストファイルのメモと同じものだ、と心が認識するんだよな。
webのリンクとかを保存していくのに違和感が無い。
だから使い始めると突然馴染む感じがあって、どんどんメモが増えていく。

最後に、普通にローカルのWikiという物が便利だったというのを忘れていた、というのもある気がする。
テキストファイルでまぁいいか、と思っていたが、良くなかった。
ローカルのテキストファイルだとメモが増えてくると邪魔になるのだが、
Wikiだとトピックごとにページを分けていけば目に入る物は限定されるので、これまでよりもどんどん増やしていって問題無い。
だからそんなに重要でないStack Overflowのリンクとかもガンガン残すようになり、これが良い。

Android版はまだ作り始めで編集が動いていないが、なんかこれもかなり良い物になりそうな気がする。
作ってみると結構Android力を要求されるものになっていて、これはあまり他の人はつくらないかも知れないな、という気分になった。

一瞬100円くらいで売ってもいいんじゃないか？と思ったが、去年今年と仕事してて別に金には困ってないし、
無料で広める方がいいか、と思ったので無料にするつもりだが、そのくらい手応えを感じる。
これ、ちゃんと宣伝すれば結構ヒットするんじゃないか？
完成したら英語圏に宣伝してみようかなぁ。

### 夜はDrawer周りと格闘

システムがダークテーマになった時の挙動が気に食わないが、MODE_NIGHT_NOでお茶を濁す。まぁいい。
Material Design Component周りはちょっと理解が深まった。
ドキュメントやサンプルは腐っているが、デザインはなかなかおしゃれで良いな。

TeFWikiのAndroid版、まぁまぁ動いてきたな。

## 2021-04-15

仕事が面倒な関数の実装が必要になったので、明日の自分に期待すべく早めに切り上げてスパ銭へ。
途中から天気がよくなってきたのでツーリングに行っても良いかと思ったが、少し花粉を感じるので無理せず予定通りスパ銭から帰ってTeFWikiの続き作る。

Material Design Componentはいろいろ落とし穴が多いが、頑張ればやりたい事は一通り出来るな。
内部の解説がなさすぎるんだよなぁ。Stack Overflowでみんな試行錯誤してる感じが酷い。
ただ出来上がったUIはまぁまぁいい感じだ。

あとはヒストリバックと設定画面作って、アイコンを書けば最初のバージョンは完成かな。

よし、ヒストリバック完成！

[おお、あかさがBOOX Note3買ってる！](https://ak3.hatenablog.com/entry/2021/04/15/003346)

なんか自分の周りのBOOX購入率がやけに高いのは、全部自分の功績なんじゃないか？
いや、いいデバイスですよね、これ。

一通り必要な実装も終えて、見た目の調整もまぁまぁやる。あとはアイコンと設定画面周りくらいだが、こういうやればできる奴はやる気が出ないんだよなぁ。
しばらく使ってみて良いかどうか判断しよう。
結構よさげに見えるが、本当に良いかは使ってみないと分からないからなぁ。

こういう時に仕事と趣味のコードが両方あるのはいいよな。仕事が詰まったら趣味コードを書き、趣味コードが詰まったら仕事コードを書く。うんうん。